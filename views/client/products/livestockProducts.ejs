<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveStock Products</title>
    <style>
                .overlay {
          position: fixed;
          top: 0;
          bottom: 0;
          left: 0;
          right: 0;
          background: rgba(0, 0, 0, 0.7);
          transition: opacity 500ms;
          visibility: hidden;
          opacity: 0;
        }
        .overlay:target {
          visibility: visible;
          opacity: 1;
        }
  
        .popup {
          margin: 70px auto;
          padding: 20px;
          background: #fff;
          border-radius: 5px;
          width: 30%;
          position: relative;
          transition: all 5s ease-in-out;
        }
  
        .popup h2 {
          margin-top: 0;
          color: #333;
          font-family: Tahoma, Arial, sans-serif;
        }
        .popup .close {
          position: absolute;
          top: 20px;
          right: 30px;
          transition: all 200ms;
          font-size: 30px;
          font-weight: bold;
          text-decoration: none;
          color: #333;
        }
        .popup .close:hover {
          color: #06d85f;
        }
        .popup .content {
          max-height: 30%;
          overflow: auto;
        }
    </style>
</head>
<body>
    <center><h1>LiveStock Products</h1></center>
    <%= resp %>
    <%= msg %>
    <div style="display: flex; flex-wrap: wrap; width: 100%; height: auto; justify-content: space-evenly;">
        <% if (products.length > 0) { %>
            <% products.forEach(product => { %>
                <div style="display: flex; justify-content: space-between; flex-direction: column; width: 30%; height: 300px; border: 2px solid black; border-radius: 2%;">
                   <img style="width: 100%; height: 70%;" src="<%= product.image %>" alt="<%= product.name %>">
                    <div style="display: flex; justify-content: space-between; height: 10%; padding-left: 5%; padding-right: 5%;">
                        <p><%= product.name %></p>
                        <p><%= product.price %> Naira</p>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; height: 10%; padding-left: 5%; padding-right: 5%;">
                        <p class="snippet"><%= product.snippet %>...</p>
                        <a class="more" onclick=`open(${<%= product._id %>}))`>See More</a>
                        <p style="display: none;" class= <%= product._id %>><%= product.content %></p>
                    </div>
                    <div style="display: flex; justify-content: center; align-items: center; height: 10%">
                        <a href="#regbuy?<%= product._id %>">Buy Now</a>
                    </div>
                </div>

                <!--  -->
                <div id="regbuy?<%= product._id %>" class="overlay">
                    <div class="popup">
                        <% const ref = Math.random().toString(36).substring(2,12); %> 
                      <h2>Add Info</h2>
                      <p><%= msg %></p>
                      <a class="close" href="">&times;</a>
                      <div class="content">
                        <form action="/regbuy/livestock" method="POST">
                            <div class="form-group">
                              <label for="email">Email Address</label>
                              <input type="email" id="email-address" name="email" required />
                            </div>
                            <div class="form-group">
                              <label for="amount">Amount</label>
                              <input type="number" id="amount" name="amount" value="<%= product.price %>" required readonly />
                            </div>
                            <div class="form-group">
                              <label for="first-name">First Name</label>
                              <input type="text" id="first-name" name="firstName" />
                            </div>
                            <div class="form-group">
                              <label for="last-name">Last Name</label>
                              <input type="text" id="last-name" name="lastName" />
                            </div>
                            <div class="form-group">
                              <label for="last-name">Reference</label>
                              <input type="text" id="last-name" name="ref" value="<%= ref %>" readonly />
                            </div>
                            <div class="form-group" style="display: none;">
                              <input type="text" id="last-name" name="product_id" value="<%= product._id %>" readonly />
                            </div>
                            <div class="form-submit">
                              <input type="submit" value="Pay">
                            </div>
                          </form>
                      </div>
                    </div>
                  </div>
               <% }) %>
        <% } else { %>
            <p>OOOPS!!! There are no LiveStock Products yet.</p>
        <% } %>
        
    </div>
    <script>
        function open(id) {
            console.log('Opened')
        }
    </script>
</body>
</html>